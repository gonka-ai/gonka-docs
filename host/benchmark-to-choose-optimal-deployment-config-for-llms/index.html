
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Learn to configure and use Gonka network">
      
      
      
        <link rel="canonical" href="https://gonka.ai/host/benchmark-to-choose-optimal-deployment-config-for-llms/">
      
      
        <link rel="prev" href="../../architecture/">
      
      
        <link rel="next" href="../genesis/">
      
      
        
          <link rel="alternate" href="./" hreflang="en">
        
          <link rel="alternate" href="../../zh/host/benchmark-to-choose-optimal-deployment-config-for-llms/" hreflang="zh">
        
      
      
      <link rel="icon" href="../../images/01-favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Benchmark to Choose Optimal Deployment Config for LLMs - </title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Manrope:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Manrope";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/nft-landing.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-JWVG5X6CY5"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-JWVG5X6CY5",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-JWVG5X6CY5",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
    
      
    
    <meta property="og:type" content="website">
    <meta property="og:title" content=" - Benchmark to Choose Optimal Deployment Config for LLMs">
    <meta property="og:description" content="Learn to configure and use Gonka network">
    <meta property="og:url" content="https://gonka.ai/host/benchmark-to-choose-optimal-deployment-config-for-llms/">
    <meta property="og:image" content="">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:width" content="1080">
    <meta property="og:image:height" content="568">
  
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#benchmark-to-choose-optimal-deployment-config-for-llms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    



      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  <img src="../../images/logos/gonka.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Benchmark to Choose Optimal Deployment Config for LLMs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh/host/benchmark-to-choose-optimal-deployment-config-for-llms/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    


    <div class="md-container" data-md-component="container">
      
      


        
          
        
      


      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  <img src="../../images/logos/gonka.svg" alt="logo">

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Developer
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Developer
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/details/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Details
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Host
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Host
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Benchmark to Choose Optimal Deployment Config for LLMs
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmark to Choose Optimal Deployment Config for LLMs
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intro
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-vllm-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding vLLM Parameters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-install-the-benchmark-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Install the Benchmark Tool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-obtain-the-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Obtain the Configuration File
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-run-the-performance-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Run the Performance Test
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-view-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. View Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-and-performance-optimization-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment and Performance Optimization Plan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment and Performance Optimization Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-establish-initial-configuration-with-mandatory-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Establish Initial Configuration with Mandatory Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-define-potential-deployment-configurations-for-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Define Potential Deployment Configurations for Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-test-each-configuration-and-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Test Each Configuration and Measure Performance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Test Each Configuration and Measure Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-deploy-the-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1. Deploy the Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-verify-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Verify Deployment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3. Measure Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-compare-performance-results-across-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Compare Performance Results Across Configurations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-qwenqwen3-32b-fp8-at-8x4070-sti-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Qwen/Qwen3-32B-FP8 at 8x4070 STi server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example: Qwen/Qwen3-32B-FP8 at 8x4070 STi server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-establish-initial-configuration-with-mandatory-parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Establish Initial Configuration with Mandatory Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-define-potential-deployment-configurations-for-testing_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Define Potential Deployment Configurations for Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deploy-and-measure-each-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Deploy and Measure Each Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Deploy and Measure Each Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-configuration-1-tp8-pp1" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Configuration 1 (TP=8, PP=1)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 Configuration 1 (TP=8, PP=1)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311-deploy" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1.1. Deploy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#312-verify-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1.2. Verify Deployment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#313-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1.3. ​​Measure Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-configuration-2-tp4-pp2" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Configuration 2 (TP=4, PP=2)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2. Configuration 2 (TP=4, PP=2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-deploy" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2.1. Deploy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-verify-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2.2. Verify Deployment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2.3. ​​Measure Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-compare-performance-results-across-configurations_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Compare Performance Results Across Configurations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../genesis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Genesis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hardware-specifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hardware specifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../host_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to edit Host public info
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../collateral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collateral
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../key-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Key management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mlnode-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ML Node Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiple-nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiple nodes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network-node-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Node API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Wallet
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Wallet
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dashboard
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/pricing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pricing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wallet/wallet-and-transfer-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wallet & transfer guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-announcements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Announcements
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model-licenses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model licenses
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software-upgrades/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software upgrades
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transactions-and-governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transactions & governance
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Help
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Help
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FAQ/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Errors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Get help
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intro
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-vllm-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding vLLM Parameters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-install-the-benchmark-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Install the Benchmark Tool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-obtain-the-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Obtain the Configuration File
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-run-the-performance-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Run the Performance Test
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-view-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. View Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-and-performance-optimization-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment and Performance Optimization Plan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment and Performance Optimization Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-establish-initial-configuration-with-mandatory-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Establish Initial Configuration with Mandatory Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-define-potential-deployment-configurations-for-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Define Potential Deployment Configurations for Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-test-each-configuration-and-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Test Each Configuration and Measure Performance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Test Each Configuration and Measure Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-deploy-the-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1. Deploy the Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-verify-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Verify Deployment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3. Measure Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-compare-performance-results-across-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Compare Performance Results Across Configurations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-qwenqwen3-32b-fp8-at-8x4070-sti-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Qwen/Qwen3-32B-FP8 at 8x4070 STi server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example: Qwen/Qwen3-32B-FP8 at 8x4070 STi server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-establish-initial-configuration-with-mandatory-parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Establish Initial Configuration with Mandatory Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-define-potential-deployment-configurations-for-testing_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Define Potential Deployment Configurations for Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-deploy-and-measure-each-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Deploy and Measure Each Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Deploy and Measure Each Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-configuration-1-tp8-pp1" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Configuration 1 (TP=8, PP=1)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 Configuration 1 (TP=8, PP=1)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311-deploy" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1.1. Deploy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#312-verify-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1.2. Verify Deployment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#313-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1.3. ​​Measure Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-configuration-2-tp4-pp2" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Configuration 2 (TP=4, PP=2)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2. Configuration 2 (TP=4, PP=2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-deploy" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2.1. Deploy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-verify-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2.2. Verify Deployment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-measure-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2.3. ​​Measure Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-compare-performance-results-across-configurations_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Compare Performance Results Across Configurations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<div><h1 id="benchmark-to-choose-optimal-deployment-config-for-llms">Benchmark to Choose Optimal Deployment Config for LLMs</h1>
<h2 id="intro">Intro</h2>
<p>Effective GPU utilization is critical for deploying large language models. Gonka Nodes utilize a customized vLLM inference engine that supports both high-performance inference and its validation.</p>
<p>To achieve the best results, vLLM requires careful, server-specific configuration. The optimal performance depends on both GPUs' characteristics and the speed of cross-GPU data transfer. This guide provides instructions on how to select vLLM parameters using the Qwen/Qwen3-32B-FP8 model as an example. We will also describe which parameters can be tuned for optimal performance without affecting validation and which parameters must remain unchanged.</p>
<p><a href="https://github.com/product-science/vllm/tree/productscience/v0.8.1">Link to our vLLM fork</a>.</p>
<h2 id="understanding-vllm-parameters">Understanding vLLM Parameters</h2>
<p>To configure a vLLM-based model deployment, you define <code>args</code> for each model:
</p><div class="highlight"><pre><span></span><code>"Qwen/Qwen3-32B-FP8": {
    "args": [
        "--tensor-parallel-size",
        "4",
        "--pipeline-parallel-size",
        "2"
    ]
}
</code></pre></div>
These args define the configuration for each vLLM instance that MLNode will manage. Detailed descriptions can be found in the <a href="https://docs.vllm.ai/en/v0.8.1/serving/engine_args.html">vLLM documentation</a>.
<p>The amount of GPUs used by a single instance of vLLM depends on two parameters: </p>
<ul>
<li><code>--tensor-parallel-size (TP)</code></li>
<li><code>--pipeline-parallel-size (PP)</code></li>
</ul>
<p>The amount of used GPUs is equal to <code>TP*PP</code> in most cases.</p>
<p>If an MLNode has more GPUs than a single instance requests, it will spin up multiple instances, utilizing the available GPUs efficiently. </p>
<p>For example, if the node has 10 GPUs and each instance is configured to use 4, MLNode will launch two instances (4 + 4 GPUs) and load-balance requests between them. In many cases, deploying a higher number of vLLM instances, with each instance utilizing a smaller count of GPUs, can be a more effective strategy.</p>
<p>There are two types of parameters in vLLM.</p>
<table>
<thead>
<tr>
<th><strong>Type</strong></th>
<th><strong>Description</strong></th>
<th><strong>Parameters</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Affects Inference</strong></td>
<td>Changes output quality or behavior. You must <strong>not</strong> modify these parameters unless explicitly allowed, as it may cause validation to fail.</td>
<td><nobr><code>--kv-cache-dtype</code></nobr><br><nobr><code>--max-model-len</code></nobr><br><nobr><code>--speculative-model</code></nobr><br><nobr><code>--dtype</code></nobr><br><nobr><code>--quantization</code></nobr> <em>etc.</em></td>
</tr>
<tr>
<td><strong>Does Not Affect Inference</strong></td>
<td>Changes how the model utilizes available GPUs.</td>
<td><nobr><code>--tensor-parallel-size</code></nobr><br><nobr><code>--pipeline-parallel-size</code></nobr><br><nobr><code>--enable-expert-parallel</code></nobr> <em>etc.</em></td>
</tr>
</tbody>
</table>
<h2 id="performance-testing">Performance testing</h2>
<p>To measure the performance of your model deployment, you'll use the <code>compressa-perf</code> tool. You can find the tool on <a href="https://github.com/product-science/compressa-perf">GitHub</a>.</p>
<h3 id="1-install-the-benchmark-tool">1. Install the Benchmark Tool</h3>
<p>First, install <code>compressa-perf</code> using pip:
</p><div class="highlight"><pre><span></span><code>pip install git+https://github.com/product-science/compressa-perf.git
</code></pre></div>
<h3 id="2-obtain-the-configuration-file">2. Obtain the Configuration File</h3>
<p>The benchmark tool uses a YAML configuration file to define test parameters. A default configuration file is available <a href="https://github.com/product-science/inference-ignite/blob/main/mlnode/packages/benchmarks/resources/config.yml">here</a>.</p>
<h3 id="3-run-the-performance-test">3. Run the Performance Test</h3>
<p>Once your model is deployed, you can test its performance. Use the following command, replacing <code>&lt;IP&gt;</code> and <code>&lt;INFERENCE_PORT&gt;</code> with your specific deployment details, and <code>MODEL_NAME</code> with the name of the model you're testing (e.g., <code>Qwen/Qwen3-32B-FP8</code>):
</p><div class="highlight"><pre><span></span><code>compressa-perf \
        measure-from-yaml \
        --no-sign \
        --node_url http://&lt;IP&gt;:&lt;INFERENCE_PORT&gt; \
        config.yml \
        --model_name MODEL_NAME
</code></pre></div>
Performance results will be saved to a file named <code>compressa-perf-db.sqlite</code>
<h3 id="4-view-results">4. View Results</h3>
<p>To display the benchmark results, including key metrics and parameters, run:
</p><div class="highlight"><pre><span></span><code>compressa-perf list --show-metrics --show-parameters
</code></pre></div>
This command will output a report with the following performance metrics:
<table>
<thead>
<tr>
<th><strong>Metric</strong></th>
<th><strong>Description</strong></th>
<th><strong>Desired Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TTFT (Time To First Token)</strong></td>
<td>Time elapsed until the <strong>first token</strong> is generated.</td>
<td>Lower is better</td>
</tr>
<tr>
<td><strong>LATENCY</strong></td>
<td>Total time taken for the model to generate the <strong>complete response</strong>.</td>
<td>Lower is better</td>
</tr>
<tr>
<td><strong>TPOT (Time Per Output Token)</strong></td>
<td>Average time to generate <strong>each token after the first one</strong>.</td>
<td>Lower is better</td>
</tr>
<tr>
<td><strong>THROUGHPUT_INPUT_TOKENS</strong></td>
<td>Input token processing speed: total <strong>prompt tokens</strong> / total response time (tokens per second).</td>
<td>Higher is better</td>
</tr>
<tr>
<td><strong>THROUGHPUT_OUTPUT_TOKENS</strong></td>
<td>Output token generation speed: total <strong>generated tokens</strong> / total response time (tokens per second).</td>
<td>Higher is better</td>
</tr>
</tbody>
</table>
<h2 id="deployment-and-performance-optimization-plan">Deployment and Performance Optimization Plan</h2>
<p>Testing is performed on a server where MLNode has been deployed according to <a href="https://gonka.ai/host/multiple-nodes/#running-the-inference-node-on-a-separate-server">the instructions</a>.
Ensure the performance tool (<code>compressa-perf</code>) is installed and the necessary configuration file has been downloaded before proceeding.</p>
<h3 id="1-establish-initial-configuration-with-mandatory-parameters">1. Establish Initial Configuration with Mandatory Parameters</h3>
<ul>
<li>Define base configuration:</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked id="__tabbed_1_1" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">"MODEL_NAME"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<h3 id="2-define-potential-deployment-configurations-for-testing">2. Define Potential Deployment Configurations for Testing</h3>
<p>Determine the range of tunable parameters you will experiment with. For performance optimization without affecting inference output, these primarily include parameters like <code>--tensor-parallel-size (TP</code>) and <code>--pipeline-parallel-size (PP)</code>, among others that do not alter inference results.</p>
<p>Choose these parameters based on your server's GPUs and the model's size. The number of GPUs used by a single vLLM instance is generally the product of tensor-parallel size and pipeline-parallel size. Multiple instances are used automatically if possible.</p>
<h3 id="3-test-each-configuration-and-measure-performance">3. Test Each Configuration and Measure Performance</h3>
<p>For each defined configuration:</p>
<h4 id="31-deploy-the-configuration">3.1. Deploy the Configuration</h4>
<p>Deploy the current configuration using the MLNode REST API endpoint:
</p><div class="highlight"><pre><span></span><code>http://&lt;IP&gt;:&lt;MANAGEMENT_PORT&gt;/api/v1/inference/up
</code></pre></div>
Python example below:
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked id="__tabbed_2_1" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>

<span class="k">def</span><span class="w"> </span><span class="nf">inference_up</span><span class="p">(</span>
   <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
   <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
   <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
   <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v1/inference/up"</span>
   <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
       <span class="s2">"model"</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
       <span class="s2">"dtype"</span><span class="p">:</span> <span class="s2">"float16"</span><span class="p">,</span>
       <span class="s2">"additional_args"</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s2">"args"</span><span class="p">]</span>
   <span class="p">}</span>

   <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
   <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

   <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="n">model_name</span> <span class="o">=</span> <span class="s2">"MODEL_NAME"</span>
<span class="n">model_config</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">"args"</span><span class="p">:</span> <span class="p">[</span>
       <span class="s2">"--tensor-parallel-size"</span><span class="p">,</span> <span class="s2">"8"</span><span class="p">,</span>
       <span class="s2">"--pipeline-parallel-size"</span><span class="p">,</span> <span class="s2">"1"</span><span class="p">,</span>
   <span class="p">]</span>
<span class="p">}</span>

<span class="n">inference_up</span><span class="p">(</span>
   <span class="n">base_url</span><span class="o">=</span><span class="s2">"http://&lt;IP&gt;:&lt;MANAGEMENT_PORT&gt;"</span><span class="p">,</span>
   <span class="n">model</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
   <span class="n">config</span><span class="o">=</span><span class="n">model_config</span>
<span class="p">)</span>
</code></pre></div>
<h4 id="32-verify-deployment">3.2. Verify Deployment</h4>
<ul>
<li>Check the MLNode logs for any errors that may have occurred during deployment.</li>
<li>Verify the deployment status by checking the REST API endpoint <code>http://&lt;IP&gt;:&lt;MANAGEMENT_PORT&gt;/api/v1/state</code>.</li>
</ul>
<p>The expected status:
</p><div class="highlight"><pre><span></span><code>{'state': 'INFERENCE'}
</code></pre></div>
<h4 id="33-measure-performance">3.3. Measure Performance</h4>
<p>Run the <code>compressa-perf</code> tool to measure the performance of the deployed configuration and collect the relevant metrics.</p>
<h3 id="4-compare-performance-results-across-configurations">4. Compare Performance Results Across Configurations</h3>
<p>Analyze the collected metrics (such as <code>TTFT</code>, <code>Latency</code>, and <code>Throughput</code>) from each tested configuration. Compare these results to identify the setup that provides the best performance for the server environment.</p>
<h2 id="example-qwenqwen3-32b-fp8-at-8x4070-sti-server">Example: <code>Qwen/Qwen3-32B-FP8</code> at 8x4070 STi server</h2>
<p>Let’s assume we have a server with 8x4070 S Ti. Each GPU has 16GB VRAM.
We have deployed the <code>MLNode</code> container to this server, with the following port mappings:</p>
<ul>
<li>API management port (default 8080) is mapped to <code>http://24.124.32.70:46195</code></li>
<li>Inference port (default 5000) is mapped to <code>http://24.124.32.70:46085</code></li>
</ul>
<p>For this example, we'll use the <code>Qwen/Qwen3-32B-FP8</code> model, which is one of the models deployed at Gonka. It has the following mandatory parameters:</p>
<ul>
<li><code>--kv-cache-dtype fp8</code></li>
<li><code>--quantization fp8</code></li>
</ul>
<h3 id="1-establish-initial-configuration-with-mandatory-parameters_1">1. Establish Initial Configuration with Mandatory Parameters</h3>
<p>Based on these mandatory parameters, the initial configuration for <code>Qwen/Qwen3-32B-FP8</code> must include:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked id="__tabbed_3_1" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">"Qwen/Qwen3-32B-FP8"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<h3 id="2-define-potential-deployment-configurations-for-testing_1">2. Define Potential Deployment Configurations for Testing</h3>
<p>The <code>Qwen/Qwen3-32B-FP8</code> model with those parameters requires at least 80GB of VRAM for efficient deployment. Therefore, we need to use at least 6x4070S Ti for each instance. We can’t fit two instances in this server and want to use all GPUs, let’s deploy a single instance that uses 8 GPUs (TP * PP = 8).
Potential configuration can include:</p>
<ul>
<li><strong>TP=8, PP=1</strong></li>
<li><strong>TP=4, PP=2</strong></li>
<li>TP=2, PP=4</li>
<li>TP=1, PP=8</li>
</ul>
<p>High pipeline parallelism typically doesn't yield good performance in a single-server deployment. Therefore, in this example, we’ll test only two configurations:</p>
<ul>
<li>Configuration 1 (TP=8, PP=1).</li>
<li>Configuration 2 (TP=4, PP=2)</li>
</ul>
<h3 id="3-deploy-and-measure-each-configuration">3. Deploy and Measure Each Configuration</h3>
<h4 id="31-configuration-1-tp8-pp1">3.1 Configuration 1 (TP=8, PP=1)</h4>
<h5 id="311-deploy">3.1.1. Deploy</h5>
<p>Use a Python script to deploy the model: </p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked id="__tabbed_4_1" name="__tabbed_4" type="radio"><div class="tabbed-labels"><label for="__tabbed_4_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p></p><div class="highlight"><pre><span></span><code><span class="o">...</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="n">Qwen</span><span class="o">/</span><span class="n">Qwen3</span><span class="o">-</span><span class="mi">32</span><span class="n">B</span><span class="o">-</span><span class="n">FP8</span><span class="s2">"</span>
<span class="n">model_config</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">"args"</span><span class="p">:</span> <span class="p">[</span>
       <span class="s2">"--tensor-parallel-size"</span><span class="p">,</span> <span class="s2">"8"</span><span class="p">,</span>
       <span class="s2">"--pipeline-parallel-size"</span><span class="p">,</span> <span class="s2">"1"</span><span class="p">,</span>
   <span class="p">]</span>
<span class="p">}</span>

<span class="n">inference_up</span><span class="p">(</span>
   <span class="n">base_url</span><span class="o">=</span><span class="s2">"http://24.124.32.70:46195"</span><span class="p">,</span>
   <span class="n">model</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
   <span class="n">config</span><span class="o">=</span><span class="n">model_config</span>
<span class="p">)</span>
</code></pre></div>
The expected status:
<div class="highlight"><pre><span></span><code>{"status": "OK"}
</code></pre></div>
<h5 id="312-verify-deployment">3.1.2. Verify Deployment</h5>
<p>In MLNode logs, we see that vLLM has been deployed successfully:
</p><div class="highlight"><pre><span></span><code>...
INFO 05-15 23:50:01 [api_server.py:1024] Starting vLLM API server on http://0.0.0.0:5000
INFO 05-15 23:50:01 [launcher.py:26] Available routes are:
INFO 05-15 23:50:01 [launcher.py:34] Route: /openapi.JSON, Methods: GET, HEAD
INFO 05-15 23:50:01 [launcher.py:34] Route: /docs, Methods: GET, HEAD
INFO 05-15 23:50:01 [launcher.py:34] Route: /docs/oauth2-redirect, Methods: GET, HEAD
INFO 05-15 23:50:01 [launcher.py:34] Route: /redoc, Methods: GET, HEAD
INFO 05-15 23:50:01 [launcher.py:34] Route: /health, Methods: GET
INFO 05-15 23:50:01 [launcher.py:34] Route: /load, Methods: GET
INFO 05-15 23:50:01 [launcher.py:34] Route: /ping, Methods: GET, POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /tokenize, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /detokenize, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /v1/models, Methods: GET
INFO 05-15 23:50:01 [launcher.py:34] Route: /version, Methods: GET
INFO 05-15 23:50:01 [launcher.py:34] Route: /v1/chat/completions, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /v1/completions, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /v1/embeddings, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /pooling, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /score, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /v1/score, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /v1/audio/transcriptions, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /rerank, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /v1/rerank, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /v2/rerank, Methods: POST
INFO 05-15 23:50:01 [launcher.py:34] Route: /invocations, Methods: POST
INFO:     Started server process [4437]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:37542 - "GET /v1/models HTTP/1.1" 200 OK
</code></pre></div>
To further verify, let's check the status via the API:
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked id="__tabbed_5_1" name="__tabbed_5" type="radio"><div class="tabbed-labels"><label for="__tabbed_5_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p></p><div class="highlight"><pre><span></span><code><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
   <span class="s2">"http://24.124.32.70:46195/api/v1/state"</span>
<span class="p">)</span><span class="o">.</span><span class="n">JSON</span><span class="p">()</span>
</code></pre></div>
The expected status:
<div class="highlight"><pre><span></span><code>{'state': 'INFERENCE'}
</code></pre></div>
The model has been deployed successfully.
<h5 id="313-measure-performance">3.1.3. ​​Measure Performance</h5>
<p>Start the performance test:
</p><div class="highlight"><pre><span></span><code>compressa-perf \
        measure-from-yaml \
        --no-sign \
        --node_url http://24.124.32.70:46085 \
        --model_name Qwen/Qwen3-32B-FP8 \
        config.yml
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Check Logs If Errors Occur</p>
<p>The configuration may still not work as expected; if errors occur, check the MLNode logs for troubleshooting. </p>
</div>
<p>When the tests are finished, we can see the result: 
</p><div class="highlight"><pre><span></span><code>compressa-perf list --show-metrics --show-parameters
</code></pre></div>
Results:
<p><img alt="Results for Configuration 1" src="../results-for-configuration-1-%28tp%3D8-pp%3D1%29.png"></p>
<h4 id="32-configuration-2-tp4-pp2">3.2. Configuration 2 (TP=4, PP=2)</h4>
<h5 id="321-deploy">3.2.1. Deploy</h5>
<p>Use a Python script to deploy the model: </p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked id="__tabbed_6_1" name="__tabbed_6" type="radio"><div class="tabbed-labels"><label for="__tabbed_6_1">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p></p><div class="highlight"><pre><span></span><code><span class="o">...</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">"Qwen/Qwen3-32B-FP8"</span>
<span class="n">model_config</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">"args"</span><span class="p">:</span> <span class="p">[</span>
       <span class="s2">"--tensor-parallel-size"</span><span class="p">,</span> <span class="s2">"4"</span><span class="p">,</span>
       <span class="s2">"--pipeline-parallel-size"</span><span class="p">,</span> <span class="s2">"2"</span><span class="p">,</span>
   <span class="p">]</span>
<span class="p">}</span>

<span class="n">inference_up</span><span class="p">(</span>
   <span class="n">base_url</span><span class="o">=</span><span class="s2">"http://24.124.32.70:46195"</span><span class="p">,</span>
   <span class="n">model</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
   <span class="n">config</span><span class="o">=</span><span class="n">model_config</span>
<span class="p">)</span>
</code></pre></div>
The expected status:
<div class="highlight"><pre><span></span><code>{"status": "OK"}
</code></pre></div>
<h5 id="322-verify-deployment">3.2.2. Verify Deployment</h5>
<p>Check that the log shows successful deployment  and <code>/api/v1/state</code> still returns <code>{'state': 'INFERENCE'}</code></p>
<h5 id="323-measure-performance">3.2.3. ​​Measure Performance</h5>
<p>Measure performance a second time using the same command:
</p><div class="highlight"><pre><span></span><code>compressa-perf \
        measure-from-yaml \
        --no-sign \
        --node_url http://24.124.32.70:46085 \
        --model_name Qwen/Qwen3-32B-FP8 \
        config.yml
</code></pre></div>
When the test finishes, we can check the results:
<div class="highlight"><pre><span></span><code>compressa-perf list --show-metrics --show-parameters
</code></pre></div>
<img alt="Results for Configuration 2" src="../results-for-configuration-2-%28tp%3D4-pp%3D2%29.png">
<h3 id="4-compare-performance-results-across-configurations_1">4. Compare Performance Results Across Configurations</h3>
<p>Our experiment shows the following metrics:</p>
<table>
<thead>
<tr>
<th><strong>Experiment</strong></th>
<th><strong>Metrics</strong></th>
<th><strong>TP 8, PP 1</strong></th>
<th><strong>TP 4, PP 2</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>~1000 token input / ~300 token output</td>
<td><strong>TTFT</strong></td>
<td>6.2342</td>
<td><strong>4.7595</strong></td>
</tr>
<tr>
<td>~1000 token input / ~300 token output</td>
<td><strong>THROUGHPUT INPUT</strong></td>
<td>497.8204</td>
<td>500.2883</td>
</tr>
<tr>
<td>~1000 token input / ~300 token output</td>
<td><strong>THROUGHPUT OUTPUT</strong></td>
<td>143.3828</td>
<td>144.0936</td>
</tr>
<tr>
<td>~1000 token input / ~300 token output</td>
<td><strong>LATENCY</strong></td>
<td>20.9172</td>
<td>20.8093</td>
</tr>
<tr>
<td>~23000 token input / ~1000 token output</td>
<td><strong>TTFT</strong></td>
<td>57.7112</td>
<td><strong>28.6839</strong></td>
</tr>
<tr>
<td>~23000 token input / ~1000 token output</td>
<td><strong>THROUGHPUT INPUT</strong></td>
<td>840.3887</td>
<td><strong>1017.6811</strong></td>
</tr>
<tr>
<td>~23000 token input / ~1000 token output</td>
<td><strong>THROUGHPUT OUTPUT</strong></td>
<td>35.7324</td>
<td><strong>43.3700</strong></td>
</tr>
<tr>
<td>~23000 token input / ~1000 token output</td>
<td><strong>LATENCY</strong></td>
<td>271.9932</td>
<td><strong>223.6245</strong></td>
</tr>
</tbody>
</table>
<p>The TP=4 and PP=2 setup shows consistently better performance, and we should use it.</p></div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "content.code.annotate", "content.code.copy", "navigation.indexes", "navigation.tracking", "search.suggest"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../assets/javascripts/links.js"></script>
      
        <script src="../../assets/javascripts/quickstart-configurator.js"></script>
      
    
  </body>
</html>